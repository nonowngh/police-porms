<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="IF_EX_API_GIS_01">

    <delete id="delete">
        DELETE FROM tb_seoul_traffic_signal
    </delete>

    <insert id="insert" parameterType="map">
        INSERT INTO tb_seoul_traffic_signal (
            history_id,
            atch_mng_no1,
            atch_mng_no2,
            plr_mng_no,
            cstrn_mng_no,
            new_nmlz_id,
            stts_cd,
            atch_mthd,
            hlvlrd,
            sgn_lmn_se,
            job_se_cd,
            exprs_se,
            atch_len,
            atch_drct,
            trfc_lght_cnt,
            tlght_cnt,
            trfc_lght_knd,
            tlght_knd,
            mkr,
            pstn_info,
            cstrn_form,
            instl_ymd,
            rplc_ymd,
            xcrd,
            ycrd,
            collect_dt
        ) VALUES (
            #{HSTRY_ID},
            #{ATCH_MNG_NO1},
            #{ATCH_MNG_NO2},
            #{PLR_MNG_NO},
            #{CSTRN_MNG_NO},
            #{NEW_NMLZ_ID},
            #{STTS_CD},
            #{ATCH_MTHD},
            #{HLVLRD},
            #{SGN_LMN_SE},
            #{JOB_SE_CD},
            #{EXPRS_SE},
            NULLIF(#{ATCH_LEN}, '')::integer,
            NULLIF(#{ATCH_DRCT}, '')::integer,
            NULLIF(#{TRFC_LGHT_CNT}, '')::integer,
            NULLIF(#{TLGHT_CNT}, '')::integer,
            #{TRFC_LGHT_KND},
            #{TLGHT_KND},
            #{MKR},
            #{PSTN_INFO},
            #{CSTRN_FORM},
            #{INSTL_YMD},
            #{RPLC_YMD},
            NULLIF(#{XCRD}, '')::numeric,
            NULLIF(#{YCRD}, '')::numeric,
            CURRENT_TIMESTAMP
        )
    </insert>

</mapper>