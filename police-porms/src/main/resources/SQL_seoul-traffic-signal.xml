<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="IF_EX_API_GIS_01">

    <delete id="delete">
        DELETE FROM tb_seoul_traffic_signal
    </delete>

    <insert id="insert" parameterType="java.util.List">
    INSERT INTO tb_seoul_traffic_signal (
        history_id,
        atch_mng_no1,
        atch_mng_no2,
        plr_mng_no,
        cstrn_mng_no,
        new_nmlz_id,
        stts_cd,
        atch_mthd,
        hlvlrd,
        sgn_lmn_se,
        job_se_cd,
        exprs_se,
        atch_len,
        atch_drct,
        trfc_lght_cnt,
        tlght_cnt,
        trfc_lght_knd,
        tlght_knd,
        mkr,
        pstn_info,
        cstrn_form,
        instl_ymd,
        rplc_ymd,
        xcrd,
        ycrd,
        collect_dt
    ) VALUES 
    <foreach collection="list" item="item" separator=",">
    (
        #{item.HSTRY_ID},
        #{item.ATCH_MNG_NO1},
        #{item.ATCH_MNG_NO2},
        #{item.PLR_MNG_NO},
        #{item.CSTRN_MNG_NO},
        #{item.NEW_NMLZ_ID},
        #{item.STTS_CD},
        #{item.ATCH_MTHD},
        #{item.HLVLRD},
        #{item.SGN_LMN_SE},
        #{item.JOB_SE_CD},
        #{item.EXPRS_SE},
        NULLIF(#{item.ATCH_LEN}, '')::integer,
        NULLIF(#{item.ATCH_DRCT}, '')::integer,
        NULLIF(#{item.TRFC_LGHT_CNT}, '')::integer,
        NULLIF(#{item.TLGHT_CNT}, '')::integer,
        #{item.TRFC_LGHT_KND},
        #{item.TLGHT_KND},
        #{item.MKR},
        #{item.PSTN_INFO},
        #{item.CSTRN_FORM},
        #{item.INSTL_YMD},
        #{item.RPLC_YMD},
        NULLIF(#{item.XCRD}, '')::numeric,
        NULLIF(#{item.YCRD}, '')::numeric,
        CURRENT_TIMESTAMP
    )
    </foreach>
  </insert>

</mapper>